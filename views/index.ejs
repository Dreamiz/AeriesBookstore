<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aeries Bookstore</title>
    <link rel="stylesheet" href="/css/index.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lora&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
</head>

<body class="bg-light">

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
    <!-- Logo -->
    <a class="navbar-brand text-warning fw-bold me-3 fs-3" href="https://aeriesbookstoren.onrender.com">Aeries Bookstore</a>
  
    <!-- Toggle n√∫t khi m√†n nh·ªè -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <!-- N·ªôi dung collapse -->
  <div class="rounded-start navbar-collapse justify-content-between mt-3 mb-2" id="navbarContent">

  <!-- Kh·ªëi t√¨m ki·∫øm -->
  <form class="input-group flex-grow-1" method="GET" action="/">
    <input type="text" class="form-control" name="search" placeholder="T√¨m ki·∫øm s√°ch..." value="<%= typeof search !== 'undefined' ? search : '' %>">
    <ul id="suggestions" class="list-group position-absolute w-100 d-none" style="top: 100%; z-index: 1050;"></ul>
    <button class="btn btn-warning rounded-end" type="submit">
      <i class="fas fa-search"></i>
    </button>
  </form>

  <!-- N√∫t gi·ªè h√†ng -->
  <button class="btn btn-dark border border-warning text-warning rounded-2 ms-3" type="button" id="cartButton">
    <i class="fas fa-shopping-cart"></i>
  </button>

  <!-- User dropdown -->
  <div class="dropdown ms-3">
    <button class="btn btn-dark border border-warning text-warning d-flex align-items-center justify-content-center me-1"
            type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false"
            style="width: 38px; height: 38px;">
      <i class="fas fa-user"></i>
    </button>
    <ul class="dropdown-menu dropdown-menu-end p-3" aria-labelledby="userDropdown" style="min-width: 250px;">
      <form>
        <div class="mb-2">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email" placeholder="Nh·∫≠p email">
        </div>
        <div class="mb-2">
          <label for="password" class="form-label">M·∫≠t kh·∫©u</label>
          <input type="password" class="form-control" id="password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
        </div>
        <button type="submit" class="btn btn-warning w-100">ƒêƒÉng nh·∫≠p</button>
        <div class="text-center mt-2">
          <a href="#" class="text-decoration-none">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω</a>
        </div>
      </form>
    </ul>
  </div>
</div>

  </nav>
        

  <div class="carousel-container">
    <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img src="/images/carousel1.jpeg" class="d-block w-100 img-fluid" alt="Image 1">
        </div>
        <div class="carousel-item">
          <img src="/images/Carousel2.jpeg" class="d-block w-100 img-fluid" alt="Image 2">
        </div>
        <div class="carousel-item">
          <img src="/images/Carousel3.jpeg" class="d-block w-100 img-fluid" alt="Image 3">
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>
  </div>
  <!-- Navbar 2 - Menu items -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark justify-content-center">
    <ul class="navbar-nav d-flex flex-row">
      <li class="nav-item mx-4">
        <a class="fs-5 text-warning" style="font-family: 'Lora', serif;" href="#">Trang ch·ªß</a>
      </li>
      <li class="nav-item mx-4">
        <a class="fs-5 text-warning" style="font-family: 'Lora', serif;" href="#">H√†ng m·ªõi</a>
      </li>
      <li class="nav-item mx-4">
        <a class="fs-5 text-warning" style="font-family: 'Lora', serif;" href="#">C·ª≠a h√†ng</a>
      </li>
      <li class="nav-item mx-4">
        <a class="fs-5 text-warning" style="font-family: 'Lora', serif;" href="#">Li√™n h·ªá</a>
      </li>
    </ul>
  </nav>

  <div class="product-section">
    <h2 class="section-title text-warning">S√°ch</h2>
    
    <!-- H√†ng s·∫£n ph·∫©m v·ªõi c√°c khung s·∫£n ph·∫©m -->
    <div class="product-container-wrapper">
      <button id="prev-btn" class="navigation-btn prev-btn fs-4">&lt;</button>

      <div class="product-container">
        <% bookdata.forEach(book => { %>
          <div class="product-card">
            <img src="<%= book.image %>" alt="Book Image" style="width:100%; height:200px; object-fit:cover; border-radius: 4px;">
            <h6 class="card-title"><%= book.name %></h6>
            <p class="card-text"><%= book.author %></p>
            <p class="card-text text-success"><strong>Gi√°: <%= book.pricef %> VNƒê</strong></p>                    
            <!-- <p class="card-text">Release Date: <%= book.date %></p> -->
            <form action="/api/cart" method="POST">
              <input type="hidden" name="bookId" value="<%= book._id %>">
              <input type="hidden" name="price" value="<%= book.price %>">
            <button class="btn btn-outline-warning" onclick="addToCart('bookId123')">üõí Th√™m v√†o gi·ªè h√†ng</button>
            </form>
          </div>
        <% }) %>
      </div>
  
      <button id="next-btn" class="navigation-btn next-btn fs-4">&gt;</button>
    </div>
  </div>

  <!-- navbar th·ª© 3 -->
  <nav class="navbar navbar-dark bg-dark justify-content-center mt-5" style="height: 60px; display: flex; align-items: center;"></nav>
  
  <!-- N√∫t S·∫Øp x·∫øp v√† N√∫t Th·ªÉ lo·∫°i n·∫±m c√πng 1 h√†ng -->
<div class="d-flex justify-content-between align-items-center">
    <!-- N√∫t Th·ªÉ lo·∫°i -->
    <div>
        <button class="btn btn-warning d-flex align-items-center gap-2" id="menu-toggle">
            <i class="bi bi-list fs-4"></i> Th·ªÉ lo·∫°i
        </button>
    </div>
  
    <!-- N√∫t S·∫Øp x·∫øp -->
    <div class="d-flex justify-content-end">
        <div class="dropdown">
            <button class="btn btn-warning dropdown-toggle" type="button" id="sort-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                S·∫Øp x·∫øp
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <li><a class="dropdown-item" href="#" onclick="applySort('price', 'asc')" id="sort-low-to-high">Gi√° t·ª´ th·∫•p ƒë·∫øn cao <i class="bi bi-arrow-up"></i></a></li>
                <li><a class="dropdown-item" href="#" onclick="applySort('price', 'desc')" id="sort-high-to-low">Gi√° t·ª´ cao ƒë·∫øn th·∫•p <i class="bi bi-arrow-down"></i></a></li>
                <li><a class="dropdown-item" href="#" onclick="applySort('date', 'desc')" id="sort-newest">H√†ng m·ªõi</a></li>
            </ul>
        </div>
    </div>
</div>

  <!-- Sidebar tr∆∞·ª£t t·ª´ tr√°i -->
  <div id="sidebar" class="bg-dark text-warning position-fixed top-0 start-0 vh-100 p-4" 
       style="width: 250px; transform: translateX(-100%); transition: transform 0.3s ease; z-index: 999;">
       <div class="d-flex justify-content-end">
        <button class="btn btn-sm btn-outline-warning" id="close-sidebar">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
    <h5 class="mb-4">Th·ªÉ lo·∫°i</h5>
    <ul class="nav flex-column">
      <li class="nav-item"><a class="nav-link text-warning" href="#">C·ªï t√≠ch</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">ƒê·ªùi s·ªëng</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">Gia ƒë√¨nh</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">H√†nh ƒë·ªông</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">Kinh d·ªã</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">Khoa h·ªçc</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">L·ªãch s·ª≠</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">L√£ng m·∫°n</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">Phi√™u l∆∞u</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">T√¢m l√Ω</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">Th·∫ßn tho·∫°i</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">Trinh th√°m</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">Vi·ªÖn t∆∞·ªüng</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">KHTN</a></li>
      <li class="nav-item"><a class="nav-link text-warning" href="#">KHXH</a></li>
      
    </ul>
  </div>

  <div class="container py-5">
    <div class="row">
      <% if (bookdata.length === 0) { %>
        <p class="text-center text-muted">Kh√¥ng t√¨m th·∫•y s√°ch n√†o.</p>
      <% } else { %>
        <% bookdata.forEach(book => { %>
            <div class="col-md-4">
                <div class="card mb-4">
                    <img src="<%= book.image %>" class="card-img-top" alt="Book Image">
                    <div class="card-body">
                        <h5 class="card-title"><%= book.name %></h5>
                        <p class="card-text"><%= book.author %></p>
                        <p class="card-text text-success"><strong>Gi√°: <%= book.pricef %> VNƒê</strong></p>                    
                        <!-- <p class="card-text">Release Date: <%= book.date %></p> -->
                        <form action="/api/cart" method="POST">
                          <input type="hidden" name="bookId" value="<%= book._id %>">
                          <input type="hidden" name="price" value="<%= book.price %>">
                          <button class="btn btn-outline-warning" onclick="addToCart('<%= book._id %>')">üõí Th√™m v√†o gi·ªè h√†ng</button>
                        </form>
                    </div>
                </div>
            </div>
        <% }) %>
      <% } %>
    </div>
  </div>
  
<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      <!-- Trang ƒë·∫ßu -->
      <li class="page-item">
        <a class="page-link border-0 bg-transparent text-warning fs-4" href="#" aria-label="First">
          <span aria-hidden="true"><<</span>
        </a>
      </li>
      <!-- Trang tr∆∞·ªõc -->
      <li class="page-item">
        <a class="page-link border-0 bg-transparent text-warning fs-4" href="#" aria-label="Previous">
          <span aria-hidden="true"><</span>
        </a>
      </li>
      <!-- C√°c s·ªë trang (v√≠ d·ª•) -->
      <li class="page-item active">
        <a class="page-link border-0 bg-transparent text-warning fs-4" href="#">1</a>
      </li>
      <li class="page-item">
        <a class="page-link border-0 bg-transparent text-warning fs-4" href="#">2</a>
      </li>
      <li class="page-item">
        <a class="page-link border-0 bg-transparent text-warning fs-4" href="#">3</a>
      </li>
      <!-- Trang ti·∫øp theo -->
      <li class="page-item">
        <a class="page-link border-0 bg-transparent text-warning fs-4" href="#" aria-label="Next">
          <span aria-hidden="true">></span>
        </a>
      </li>
      <!-- Trang cu·ªëi c√πng -->
      <li class="page-item">
        <a class="page-link border-0 bg-transparent text-warning fs-4" href="#" aria-label="Last">
          <span aria-hidden="true">>></span>
        </a>
      </li>
    </ul>
  </nav>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const toggleButton = document.getElementById('menu-toggle');
    const sidebar = document.getElementById('sidebar');
  
    let sidebarVisible = false;
  
    toggleButton.addEventListener('click', () => {
      sidebarVisible = !sidebarVisible;
      sidebar.style.transform = sidebarVisible ? 'translateX(0)' : 'translateX(-100%)';
    });

    const closeButton = document.getElementById('close-sidebar');
    closeButton.addEventListener('click', () => {
    sidebar.style.transform = 'translateX(-100%)';
    sidebarVisible = false;
    });

    document.addEventListener('click', (event) => {
    if (sidebarVisible && !sidebar.contains(event.target) && !toggleButton.contains(event.target)) {
    sidebar.style.transform = 'translateX(-100%)';
    sidebarVisible = false;
    }
    });

// Event listeners cho c√°c n√∫t s·∫Øp x·∫øp
document.getElementById("sort-low-to-high").addEventListener("click", sortLowToHigh);
document.getElementById("sort-high-to-low").addEventListener("click", sortHighToLow);
document.getElementById("sort-newest").addEventListener("click", sortNewest);

document.addEventListener('DOMContentLoaded', () => {
  const prevButton = document.getElementById('prev-btn');
  const nextButton = document.getElementById('next-btn');
  const productContainer = document.querySelector('.product-container');
  const productCards = document.querySelectorAll('.product-card');

  if (productCards.length === 0) return;
  
  let currentPosition = 0;

  function getProductWidth() {
    const card = productCards[0];
    const style = getComputedStyle(card);
    const width = card.offsetWidth;
    const marginRight = parseInt(style.marginRight || 20);
    return width + marginRight;
  }

  nextButton.addEventListener('click', function () {
    const containerVisibleWidth = document.querySelector('.product-container-wrapper').offsetWidth;
    const totalScrollWidth = productContainer.scrollWidth;
    const productWidth = getProductWidth();

    if (currentPosition + containerVisibleWidth < totalScrollWidth) {
      currentPosition += productWidth;
      productContainer.style.transform = `translateX(-${currentPosition}px)`;
    }
  });

  prevButton.addEventListener('click', function () {
    const productWidth = getProductWidth();
    if (currentPosition > 0) {
      currentPosition -= productWidth;
      productContainer.style.transform = `translateX(-${currentPosition}px)`;
    }
  });
});

function applySort(sort, order) {
    const urlParams = new URLSearchParams(window.location.search);
    urlParams.set('sort', sort);
    urlParams.set('order', order);
    urlParams.set('page', 1); // Reset to page 1 when sorting
    window.location.search = urlParams.toString();
}


const input = document.getElementById('searchInput');
const suggestions = document.getElementById('suggestions');

// L·∫•y l·ªãch s·ª≠ t·ª´ localStorage
let history = JSON.parse(localStorage.getItem('searchHistory')) || [];

// Render g·ª£i √Ω
function renderSuggestions() {
  suggestions.innerHTML = '';
  history.forEach((item, index) => {
    const li = document.createElement('li');
    li.className = 'list-group-item d-flex justify-content-between align-items-center';
    li.textContent = item;

    const btn = document.createElement('button');
    btn.className = 'btn btn-sm btn-danger';
    btn.textContent = 'X';
    btn.onclick = () => {
      history.splice(index, 1);
      localStorage.setItem('searchHistory', JSON.stringify(history));
      renderSuggestions();
    };

    li.appendChild(btn);
    suggestions.appendChild(li);
  });
}

// L∆∞u t·ª´ kh√≥a m·ªõi
input.addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    const value = input.value.trim();
    if (value && !history.includes(value)) {
      history.unshift(value);
      if (history.length > 5) history.pop(); // gi·ªØ t·ªëi ƒëa 5 g·ª£i √Ω
      localStorage.setItem('searchHistory', JSON.stringify(history));
    }
    renderSuggestions();
  }
});

// Hi·ªán g·ª£i √Ω khi focus
input.addEventListener('focus', renderSuggestions);

// ·∫®n g·ª£i √Ω khi click b√™n ngo√†i
document.addEventListener('click', e => {
  if (!input.contains(e.target) && !suggestions.contains(e.target)) {
    suggestions.innerHTML = '';
  }
});

function addToCart(bookId) {
    console.log("Th√™m v√†o gi·ªè h√†ng:", bookId);
    // G·ª≠i request b·∫±ng fetch/AJAX t√πy b·∫°n mu·ªën x·ª≠ l√Ω th√™m
  }

  </script>  
      
</body>
<footer class="bg-dark text-warning text-center py-4">
    <div class="container">
        <p class="mb-1"><strong>Aeries Bookstore</strong></p> <!-- T√™n c·ª≠a h√†ng -->
        <p class="mb-1">Li√™n h·ªá: <a href="mailto:info@AeriesBookstore_283.com" class="text-warning">info@AeriesBookstore_283.com</a></p> <!-- Th√¥ng tin li√™n h·ªá -->
        <p>ƒê·ªãa ch·ªâ: S·ªë 28/3, ƒê∆∞·ªùng Minh Ph·ª•ng, Th√†nh ph·ªë H·ªì Ch√≠ Minh</p> <!-- ƒê·ªãa ch·ªâ -->
        <p>&copy; 2025 Aeries Bookstore. T·∫•t c·∫£ c√°c quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
    </div>
</footer>

</html>